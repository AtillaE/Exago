#!/bin/sh
#
# This program invokes the erlang emulator by calling run_erl.
# It should only be used at an embedded target system.
# It should be modified to give the correct flags to erl (via start_erl),
# e.g -mode embedded -sname XXX
#
# Usage: start [Data]
#

ROOTDIR=$(cd "$(dirname $0)/.." && pwd)
NODE=exago
# Use short hostname, as we are using -sname.  Cygwin doesn't have
# "hostname -s", so we do it ourselves.
HOST=$(hostname | sed -e 's/\..*$//')
cd "$ROOTDIR"

if [ -z "$RELDIR" ]
then
   RELDIR=$ROOTDIR/releases
fi

START_ERL_DATA=${1:-$RELDIR/start_erl.data}

"$ROOTDIR/bin/run_erl" -daemon "$ROOTDIR/pipes/" "$ROOTDIR/log" "exec \"$ROOTDIR/bin/start_erl\" \"$ROOTDIR\" \"$RELDIR\" \"$START_ERL_DATA\" -sname $NODE@$HOST"
